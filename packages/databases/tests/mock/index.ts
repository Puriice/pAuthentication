import { tests } from "../../src/orm/tables"
import { use } from "../../src/orm"
import { createSQL } from "./pg"
import type { Rows } from "../../types";
import type { testsTable } from "../../src/tables";

export async function prep() {
	const pg = createSQL();

	const { select, insert, update, del, count } = use(pg)

	const data = [
		{
			id: 1,
			smallint: 12,
			integer: 345,
			bigint: 9007199254740991n,
			numeric: "12345.67",
			real: 3.14,
			double: 2.718281828,
			varchar: "example varchar",
			text: "example text value",
			boolean: true,
			date: new Date("1995-06-15"),
			timestamp: new Date("2024-01-01T10:30:00"),
			timestamptz: new Date("2024-01-01T10:30:00Z"),
			interval: "2 days 03:04:05",
			uuid: "550e8400-e29b-41d4-a716-446655440000",
			json: { role: "admin", active: true },
			bytea: new Uint8Array([1, 2, 3, 4]),
			// intArray: [1, 2, 3],
			textArray: ["alpha", "beta", "gamma"],
			null: null,
			createAt: new Date("2024-01-01T10:30:00Z"),
			lastModified: new Date("2024-01-01T10:30:00Z")
		},
		{
			id: 2,
			smallint: -5,
			integer: 0,
			bigint: 42n,
			numeric: "0.99",
			real: -1.5,
			double: 0.000001,
			varchar: "another row",
			text: "Example text value",
			boolean: false,
			date: new Date("2000-01-01"),
			timestamp: new Date("2023-12-31T23:59:59"),
			timestamptz: new Date("2023-12-31T23:59:59Z"),
			interval: "0 days 00:00:10",
			uuid: "6ba7b810-9dad-11d1-80b4-00c04fd430c8",
			json: { role: "user", active: false },
			bytea: new Uint8Array([255, 0, 127]),
			// intArray: [],
			textArray: ["single"],
			null: null,
			createAt: new Date("2023-12-31T23:59:59Z"),
			lastModified: new Date("2023-12-31T23:59:59Z")
		},
		{
			id: 3,
			smallint: 7,
			integer: 123,
			bigint: 10000000000n,
			numeric: "10.50",
			real: 1.1,
			double: 1.01,
			varchar: "row 3",
			text: "text row 3",
			boolean: true,
			date: new Date("1990-03-10"),
			timestamp: new Date("2024-02-01T08:00:00"),
			timestamptz: new Date("2024-02-01T08:00:00Z"),
			interval: "1 day",
			uuid: "11111111-1111-1111-1111-111111111111",
			json: { index: 3 },
			bytea: new Uint8Array([3, 3, 3]),
			// intArray: [3],
			textArray: ["three"],
			null: null,
			createAt: new Date("2024-02-01T08:00:00Z"),
			lastModified: new Date("2024-02-01T08:00:00Z")
		},
		{
			id: 4,
			smallint: 9,
			integer: 456,
			bigint: 88n,
			numeric: "4.00",
			real: 4.4,
			double: 4.44,
			varchar: "row 4",
			text: "text row 4",
			boolean: false,
			date: new Date("1988-08-08"),
			timestamp: new Date("2024-02-02T09:00:00"),
			timestamptz: new Date("2024-02-02T09:00:00Z"),
			interval: "4 hours",
			uuid: "22222222-2222-2222-2222-222222222222",
			json: { index: 4 },
			bytea: new Uint8Array([4]),
			// intArray: [4, 4],
			textArray: ["four"],
			null: null,
			createAt: new Date("2024-02-02T09:00:00Z"),
			lastModified: new Date("2024-02-02T09:00:00Z")
		},
		{
			id: 5,
			smallint: 1,
			integer: 789,
			bigint: 5n,
			numeric: "5.55",
			real: 5.5,
			double: 5.55,
			varchar: "row 5",
			text: "text row 5",
			boolean: true,
			date: new Date("1999-05-05"),
			timestamp: new Date("2024-02-03T10:00:00"),
			timestamptz: new Date("2024-02-03T10:00:00Z"),
			interval: "5 days",
			uuid: "33333333-3333-3333-3333-333333333333",
			json: { index: 5 },
			bytea: new Uint8Array([5]),
			// intArray: [5],
			textArray: ["five"],
			null: null,
			createAt: new Date("2024-02-03T10:00:00Z"),
			lastModified: new Date("2024-02-03T10:00:00Z")
		},
		{
			id: 6,
			smallint: 6,
			integer: 600,
			bigint: 600n,
			numeric: "6.00",
			real: 6.6,
			double: 6.66,
			varchar: "row 6",
			text: "text row 6",
			boolean: false,
			date: new Date("1996-06-06"),
			timestamp: new Date("2024-02-04T11:00:00"),
			timestamptz: new Date("2024-02-04T11:00:00Z"),
			interval: "6 hours",
			uuid: "44444444-4444-4444-4444-444444444444",
			json: { index: 6 },
			bytea: new Uint8Array([6]),
			// intArray: [6],
			textArray: ["six"],
			null: null,
			createAt: new Date("2024-02-04T11:00:00Z"),
			lastModified: new Date("2024-02-04T11:00:00Z")
		},
		{
			id: 7,
			smallint: 7,
			integer: 700,
			bigint: 700n,
			numeric: "7.77",
			real: 7.7,
			double: 7.77,
			varchar: "row 7",
			text: "text row 7",
			boolean: true,
			date: new Date("1997-07-07"),
			timestamp: new Date("2024-02-05T12:00:00"),
			timestamptz: new Date("2024-02-05T12:00:00Z"),
			interval: "7 minutes",
			uuid: "55555555-5555-5555-5555-555555555555",
			json: { index: 7 },
			bytea: new Uint8Array([7]),
			// intArray: [7],
			textArray: ["seven"],
			null: null,
			createAt: new Date("2024-02-05T12:00:00Z"),
			lastModified: new Date("2024-02-05T12:00:00Z")
		},
		{
			id: 8,
			smallint: 8,
			integer: 800,
			bigint: 800n,
			numeric: "8.88",
			real: 8.8,
			double: 8.88,
			varchar: "row 8",
			text: "text row 8",
			boolean: false,
			date: new Date("1998-08-08"),
			timestamp: new Date("2024-02-06T13:00:00"),
			timestamptz: new Date("2024-02-06T13:00:00Z"),
			interval: "8 seconds",
			uuid: "66666666-6666-6666-6666-666666666666",
			json: { index: 8 },
			bytea: new Uint8Array([8]),
			// intArray: [8],
			textArray: ["eight"],
			null: null,
			createAt: new Date("2024-02-06T13:00:00Z"),
			lastModified: new Date("2024-02-06T13:00:00Z")
		},
		{
			id: 9,
			smallint: 9,
			integer: 900,
			bigint: 900n,
			numeric: "9.99",
			real: 9.9,
			double: 9.99,
			varchar: "row 9",
			text: "text row 9",
			boolean: true,
			date: new Date("1999-09-09"),
			timestamp: new Date("2024-02-07T14:00:00"),
			timestamptz: new Date("2024-02-07T14:00:00Z"),
			interval: "9 days",
			uuid: "77777777-7777-7777-7777-777777777777",
			json: { index: 9 },
			bytea: new Uint8Array([9]),
			// intArray: [9],
			textArray: ["nine"],
			null: null,
			createAt: new Date("2024-02-07T14:00:00Z"),
			lastModified: new Date("2024-02-07T14:00:00Z")
		},
		{
			id: 10,
			smallint: 10,
			integer: 1000,
			bigint: 1000n,
			numeric: "10.10",
			real: 10.1,
			double: 10.01,
			varchar: "row 10",
			text: "text row 10",
			boolean: false,
			date: new Date("1990-10-10"),
			timestamp: new Date("2024-02-08T15:00:00"),
			timestamptz: new Date("2024-02-08T15:00:00Z"),
			interval: "10 hours",
			uuid: "88888888-8888-8888-8888-888888888888",
			json: { index: 10 },
			bytea: new Uint8Array([10]),
			// intArray: [10],
			textArray: ["ten"],
			null: null,
			createAt: new Date("2024-02-08T15:00:00Z"),
			lastModified: new Date("2024-02-08T15:00:00Z")
		},
		{
			id: 11,
			smallint: 11,
			integer: 1100,
			bigint: 1100n,
			numeric: "11.11",
			real: 11.1,
			double: 11.11,
			varchar: "row 11",
			text: "text row 11",
			boolean: true,
			date: new Date("1991-11-11"),
			timestamp: new Date("2024-02-09T16:00:00"),
			timestamptz: new Date("2024-02-09T16:00:00Z"),
			interval: "11 days",
			uuid: "99999999-9999-9999-9999-999999999999",
			json: { index: 11 },
			bytea: new Uint8Array([11]),
			// intArray: [11],
			textArray: ["eleven"],
			null: 1,
			createAt: new Date("2024-02-09T16:00:00Z"),
			lastModified: new Date("2024-02-09T16:00:00Z")
		},
		{
			id: 12,
			smallint: 12,
			integer: 1200,
			bigint: 1200n,
			numeric: "12.12",
			real: 12.1,
			double: 12.12,
			varchar: "row 12",
			text: "text row 12",
			boolean: false,
			date: new Date("1992-12-12"),
			timestamp: new Date("2024-02-10T17:00:00"),
			timestamptz: new Date("2024-02-10T17:00:00Z"),
			interval: "12 hours",
			uuid: "aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",
			json: { index: 12 },
			bytea: new Uint8Array([12]),
			// intArray: [12],
			textArray: ["twelve"],
			null: 1,
			createAt: new Date("2024-02-10T17:00:00Z"),
			lastModified: new Date("2024-02-10T17:00:00Z")
		},
		{
			id: 13,
			smallint: 13,
			integer: 1300,
			bigint: 1300n,
			numeric: "13.13",
			real: 13.1,
			double: 13.13,
			varchar: "row 13",
			text: "text row 13",
			boolean: true,
			date: new Date("1993-01-13"),
			timestamp: new Date("2024-02-11T18:00:00"),
			timestamptz: new Date("2024-02-11T18:00:00Z"),
			interval: "13 minutes",
			uuid: "bbbbbbbb-bbbb-bbbb-bbbb-bbbbbbbbbbbb",
			json: { index: 13 },
			bytea: new Uint8Array([13]),
			// intArray: [13],
			textArray: ["thirteen"],
			null: 1,
			createAt: new Date("2024-02-11T18:00:00Z"),
			lastModified: new Date("2024-02-11T18:00:00Z")
		},
		{
			id: 14,
			smallint: 14,
			integer: 1400,
			bigint: 1400n,
			numeric: "14.14",
			real: 14.1,
			double: 14.14,
			varchar: "row 14",
			text: "text row 14",
			boolean: false,
			date: new Date("1994-02-14"),
			timestamp: new Date("2024-02-12T19:00:00"),
			timestamptz: new Date("2024-02-12T19:00:00Z"),
			interval: "14 seconds",
			uuid: "cccccccc-cccc-cccc-cccc-cccccccccccc",
			json: { index: 14 },
			bytea: new Uint8Array([14]),
			// intArray: [14],
			textArray: ["fourteen"],
			null: 1,
			createAt: new Date("2024-02-12T19:00:00Z"),
			lastModified: new Date("2024-02-12T19:00:00Z")
		},
		{
			id: 15,
			smallint: 15,
			integer: 1500,
			bigint: 1500n,
			numeric: "15.15",
			real: 15.1,
			double: 15.15,
			varchar: "row 15",
			text: "text row 15",
			boolean: true,
			date: new Date("1995-03-15"),
			timestamp: new Date("2024-02-13T20:00:00"),
			timestamptz: new Date("2024-02-13T20:00:00Z"),
			interval: "15 days",
			uuid: "dddddddd-dddd-dddd-dddd-dddddddddddd",
			json: { index: 15 },
			bytea: new Uint8Array([15]),
			// intArray: [15],
			textArray: ["fifteen"],
			null: 1,
			createAt: new Date("2024-02-13T20:00:00Z"),
			lastModified: new Date("2024-02-13T20:00:00Z")
		},
		{
			id: 16,
			smallint: 16,
			integer: 1600,
			bigint: 1600n,
			numeric: "16.16",
			real: 16.1,
			double: 16.16,
			varchar: "row 16",
			text: "text row 16",
			boolean: false,
			date: new Date("1996-04-16"),
			timestamp: new Date("2024-02-14T21:00:00"),
			timestamptz: new Date("2024-02-14T21:00:00Z"),
			interval: "16 hours",
			uuid: "eeeeeeee-eeee-eeee-eeee-eeeeeeeeeeee",
			json: { index: 16 },
			bytea: new Uint8Array([16]),
			// intArray: [16],
			textArray: ["sixteen"],
			null: 1,
			createAt: new Date("2024-02-14T21:00:00Z"),
			lastModified: new Date("2024-02-14T21:00:00Z")
		},
		{
			id: 17,
			smallint: 17,
			integer: 1700,
			bigint: 1700n,
			numeric: "17.17",
			real: 17.1,
			double: 17.17,
			varchar: "row 17",
			text: "text row 17",
			boolean: true,
			date: new Date("1997-05-17"),
			timestamp: new Date("2024-02-15T22:00:00"),
			timestamptz: new Date("2024-02-15T22:00:00Z"),
			interval: "17 minutes",
			uuid: "ffffffff-ffff-ffff-ffff-ffffffffffff",
			json: { index: 17 },
			bytea: new Uint8Array([17]),
			// intArray: [17],
			textArray: ["seventeen"],
			null: 1,
			createAt: new Date("2024-02-15T22:00:00Z"),
			lastModified: new Date("2024-02-15T22:00:00Z")
		},
		{
			id: 18,
			smallint: 18,
			integer: 1800,
			bigint: 1800n,
			numeric: "18.18",
			real: 18.1,
			double: 18.18,
			varchar: "row 18",
			text: "text row 18",
			boolean: false,
			date: new Date("1998-06-18"),
			timestamp: new Date("2024-02-16T23:00:00"),
			timestamptz: new Date("2024-02-16T23:00:00Z"),
			interval: "18 seconds",
			uuid: "12121212-1212-1212-1212-121212121212",
			json: { index: 18 },
			bytea: new Uint8Array([18]),
			// intArray: [18],
			textArray: ["eighteen"],
			null: 1,
			createAt: new Date("2024-02-16T23:00:00Z"),
			lastModified: new Date("2024-02-16T23:00:00Z")
		},
		{
			id: 19,
			smallint: 19,
			integer: 1900,
			bigint: 1900n,
			numeric: "19.19",
			real: 19.1,
			double: 19.19,
			varchar: "row 19",
			text: "text row 19",
			boolean: true,
			date: new Date("1999-07-19"),
			timestamp: new Date("2024-02-17T00:00:00"),
			timestamptz: new Date("2024-02-17T00:00:00Z"),
			interval: "19 days",
			uuid: "34343434-3434-3434-3434-343434343434",
			json: { index: 19 },
			bytea: new Uint8Array([19]),
			// intArray: [19],
			textArray: ["nineteen"],
			null: 1,
			createAt: new Date("2024-02-17T00:00:00Z"),
			lastModified: new Date("2024-02-17T00:00:00Z")
		},
		{
			id: 20,
			smallint: 20,
			integer: 2000,
			bigint: 2000n,
			numeric: "20.20",
			real: 20.2,
			double: 20.02,
			varchar: "row 20",
			text: "text row 20",
			boolean: false,
			date: new Date("2000-08-20"),
			timestamp: new Date("2024-02-18T01:00:00"),
			timestamptz: new Date("2024-02-18T01:00:00Z"),
			interval: "20 hours",
			uuid: "56565656-5656-5656-5656-565656565656",
			json: { index: 20 },
			bytea: new Uint8Array([20]),
			// intArray: [20],
			textArray: ["twenty"],
			null: 1,
			createAt: new Date("2024-02-18T01:00:00Z"),
			lastModified: new Date("2024-02-18T01:00:00Z")
		}
	] as const satisfies Rows<typeof testsTable>

	async function populate() {
		const result = await insert(tests).run(
			...data
		)

		if (!result) {
			console.error('Insertion abort.')
		}
	}
	async function clearTable() {
		await del(tests).danger().run();
	}

	return {
		pg,
		select,
		insert,
		update,
		del,
		count,
		data,
		populate,
		clearTable,
		close: pg.close
	}
}
